# contributed by Luca Marsella and MKr (CSCS)
easyblock = 'CmdCp'

name = 'c2sm-rcm'
version = '1.00.00'
system = 'kesch'

versionsuffix = '-%s' % system

homepage = 'https://github.com/C2SM-RCM/c2sm-rcm-env'
description = 'C2SM Environment'

toolchain = {'name': 'dummy', 'version': ''}

installdir = '%(installdir)s'

sources = [{
    'filename': 'c2sm-rcm-1.00.00-dev.tar.gz',
    'git_config': {
        'url': 'https://github.com/kraushm',
        'repo_name': 'c2sm-rcm-env',
        'tag': 'kesch/CrayCCE-18.12',
        #'commit': 'd2bf70090550f0b9b24958f2d31f377276cb5b39',
    }
}]

skipsteps = ['build']

files_to_copy = [
    (["modules/%s" % system], '%(installdir)s')
    ]

add_to_module = """
conflict %s
module use %s/%s
"""

modtclfooter = add_to_module % (name, installdir, system) 

sanity_check_paths = {
    'files': ['%s/c2sm/base' % (system),
              '%s/c2sm/cray-env/base' % (system),
              '%s/c2sm/cray-env/gpu' % (system),
              '%s/c2sm/gnu-env/base' % (system),
              '%s/c2sm/gnu-env/gpu' % (system),
              '%s/c2sm/pgi-env/base' % (system),
              '%s/c2sm/pgi-env/gpu' % (system)],
    'dirs':  ['%s/c2sm/cray-env' % (system),
              '%s/c2sm/gnu-env' % (system),
              '%s/c2sm/pgi-env' % (system)],
}

moduleclass = 'devel'
